# ポアソン過程

[計数過程](./counting-process.md)の特別な形

## 定義

[計数過程](./counting-process.md)$\{ N(t) \}_{t \in \mathbb R_+ }$が**ポアソン過程**であるとは次の条件をみたすことをいう。

1. $\forall n \in \mathbb N,\; 0 =t_0<t_1<\cdots <t_n$に対して$N(t_i)-N(t_{i-1}), \; i=1,2,...,n$が互いに独立（**独立増分性**）
2. ある関数$\lambda: \mathbb R_+ \to \mathbb R_+$が存在して$\forall s,t \in\mathbb R_+\;(s<t)$に対して$N(t)-N(s)$がパラメータ$\int ^t_s \lambda(u)du$のポアソン分布に従う

ここで、関数$\lambda (u)$のことを**強度関数**という。強度関数がポアソン分布のパラメータの変化を表現している。

一般に、強度関数によってパラメータが変化するので**時間経過によって分布は変化する**。特別な場合として強度関数が定数関数であるとき、分布が時間間隔に比例して、**斉時**であるという。離散のマルコフ連鎖では、「斉時」といったとき分布が変化していなかったが、連続のマルコフ連鎖ではどれだけの区間を見るかによって分布が変わってしまう。

**斉時なポアソン過程は連続時間マルコフ連鎖の特別な場合になる**。その点で、斉時なポアソン過程は重要である。

## 斉時なポアソン過程の性質

### 期待値

$\forall s,t \in \mathbb R_+,\;s<t$に対して
$$E[N(t) -N(s)] = \lambda (t-s)$$
が成り立つ。これは、
$$N(t)-N(s)\sim Po(\lambda(t-s))$$
が成り立つことから言えることである。

### 定常増分性

$\forall s,t\in\mathbb R_+$と$k\in\mathbb N_0$に対して
$$P(N(t+s)-N(s)=k)=P(N(t)=k)$$
が成り立つ。これは離散でいうところの**マルコフ性みたいな**性質で、過去の情報に左右されずにある時点からの長さだけで分布が決まることを表している。これは**斉時なポアソン過程で成り立つ**ことである。

### 単純性

微小時間で事象が起こる確率を考える。まず、微小時間で事象が1回起こる場合を考えると
$$P(N(\Delta t)\ge 1) = \lambda\Delta t +o(\Delta t)$$
が成り立つ。これは
$$P(N(\Delta t)\ge 1)=1-P(N(\Delta t)=0)=1-e^{-\lambda \Delta t}$$
をテイラー展開することで証明できる。

続いて2回起こる場合を考えると、
$$P(N(\Delta t)\ge 2)=o(t)$$
が成り立つ。これも上と同様に
$$P(N(\Delta t)\ge 2)=1-P(N(\Delta t)\in\{0,1\})=1-e^{-\lambda \Delta t}-\lambda \Delta te^{-\lambda \Delta t}$$
と考えて、テイラー展開することで証明できる。

### 条件付き一様性

ある時点$t$までに$k$回の事象が起こったとする。つまり、$N(t)=k$とする。このとき、これら$k$個の点は$(0,t]$上に**一様に分布する**。

## 独立増分性＋単純→ポアソン過程

定常増分性、独立増分性と単純性を仮定すると、計数過程はポアソン過程になる。これを定義として採用することもあって、

1. $N(t)$は定常独立増分をもつ
2. 十分小さい$h$について、$P(N(h)=1) = \lambda h+o(h)$
3. 十分小さい$h$について、$P(N(h)\ge 2)=o(h)$

が成り立つような計数過程をポアソン過程だと定義しても良い。

## ポアソン過程の重ね合わせ

ポアソン過程を足してもポアソン過程になる。

$\{N_1(t)\}, \{N_2(t)\}$をそれぞれ強度$\lambda_1, \lambda_2$を持つポアソン過程であるとする。このとき、
$$N(t) = N_1(t)+N_2(t)$$
で定まる確率過程$\{N(t)\}$は強度$\lambda_1+\lambda_2$のポアソン過程になる。
これは、ポアソン過程が確率的に起こるイベントの回数をモデル化していることを考えれば納得できるような気もする。

### 可算無限個の重ね合わせ

重ね合わせるポアソン過程の数が可算無限個であっても、収束すればポアソン過程になる。$\{N_i(t)\}$を互いに独立な、強度$\lambda_i$を持つポアソン過程とする。もしも
$$\sum^{\infty}_{i=1}\lambda_i=\bar\lambda<\infty$$
なら、重ね合わせたポアソン過程
$$\bar N(t) = \sum^{\infty}_{i=1}N_i(t)$$
は強度が$\bar\lambda$を持つポアソン過程になる。
