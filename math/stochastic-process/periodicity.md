# 周期性

[既約](./irreducible.md)なマルコフ連鎖の周期が1よりも大きいこと

まずは周期を定義しないといけない

## 周期

$P=(p_{i,j})_{i,j\in\mathcal S}$を推移確率行列として、状態$i\in \mathcal S$の**周期**が$d_i$であるとは、
$$d_i = \gcd \{n\in \mathbb N \mid p_{i,i}^{(n)}>0\}$$
となることをいう。ここで、
$$\{n \in \mathbb N \mid p_{i,i}^{(n)} > 0\} = \emptyset$$
つまり、元の状態に戻ってこれないときは$d_i = \infty$とする。

間違えそうなので注意しておくと、**周期はマルコフ連鎖に対して決まるのではなく、状態に対して決まる**。なので、状態ごとに周期が異なることがありうる。

周期が1であるとき**非周期的**という。これはイメージ通りで、周期が1ということは、返ってくるまでのステップ数としてあり得る整数がすべて互いに素であるということである。

### 連結クラス内の状態は周期が同じ

これは重要な性質で、当たり前といえば当たり前だけど使える性質。

2つの異なる状態$i,j$を用意して、
$$p^{(n)}_{i,j}>0, \;p^{(m)}_{j,i}>0$$
であるとする。
$$p^{(n+m)}_{i,i} = \sum_{k\in\mathcal S}p^{(n)}_{i,k}p^{(m)}_{k,i}\ge p^{(n)}_{i,j}p^{(m)}_{j,i}>0$$
なので、周期の定義から$n+m$は$d_i$の倍数である。

$l\in\mathbb N$を$p^{(l)}_{j,j} > 0$となるようにとると、
$$p_{i,i}^{(n+l+m)}\ge p_{i,j}^{(n)}p^{(l)}_{j,j}p^{(m)}_{j,i}>0$$
なので、またまた周期の定義から$n+l+m$は$d_i$の倍数である。

上の結果と合わせて
$$(n+l+m) - (n+m)=l$$
より、$l$は$d_i$の倍数である。$l$は戻ってくるまでのステップ数を任意に取ったものなので、**$l$の取りうる値は$d_j$の倍数**である。つまり
$$\{d_jの倍数\}\subset \{d_iの倍数\}$$
が成り立つ。

$i$と$j$を入れ替えることで逆のことが言えるので、
$$\{d_jの倍数\} =\{d_iの倍数\}$$
である。よって、$i$の周期と$j$の周期が一致する。（証明終わり）

このことから、**既約なマルコフ連鎖の状態はすべて周期が同じ**であると言える。

## 周期的

上の議論で、[[連結性]]なマルコフ連鎖の周期はすべて一致するとわかった。

もしも、既約なマルコフ連鎖の周期が1であれば**非周期的**であるという。
そうでなければ**周期的**であるという。

このような言い回しでは**マルコフ連鎖に対して周期が決まっている**と見てもいい。ただし、このような言い回しが許されるのは既約なときだけである。

## 循環クラス

既約なマルコフ連鎖の周期が$d\in\mathbb N$であるとき、状態空間$\mathcal S$を$d$個の状態集合に分割することができる。割ったあまりで分類するみたいなイメージ。

分割は$C_0,C_1,...,C_{d-1}$が
$$\sum_{j\in C_{k+1}}p_{i,j}=1$$
をみたすようになっている。つまり、$C_0$の次はかならず$C_1$のどれか。$C_1$の次は必ず$C_2$のどれか。のようになっていて、
$$C_0\to C_1\to \cdots \to C_{d-1}\to C_0$$
のようにして遷移していきます。
