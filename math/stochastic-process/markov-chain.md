# マルコフ連鎖

[確率過程](./index.md)$\{X_n\}_{n\ge 0}$が遷移確率$p$の**マルコフ連鎖**であるとは
$$P(X_{n+1} \in A \mid X_m , m\le n) = p(X_n, A)$$
が成り立つときを言う。特に$X_o$の分布$\mu$を**初期分布**という

このように、ある時刻での状態が与えられたとき、**将来の状態が過去に依存しないこと**を**マルコフ性**という。
この性質のおかげで、確率的に遷移するオートマトンのように思うことができて、状態遷移図を書くことができる。

## マルコフ連鎖の分類

マルコフ「連鎖」と言った場合、通常は**状態空間が高々加算である**ような過程を考える。

- 離散時間マルコフ連鎖
- [連続時間マルコフ連鎖](./continuous-time-markov-chain.md)
  - [計数過程](./counting-process.md)
  - [ポアソン過程](./poisson-process.md)

### 性質の違い

- [斉時](./time-homogeneous.md)(せいじ)
  - どの時刻でも分布が変わらない
- [既約](./irreducible.md)
  - 状態空間がただ1つの連結クラスからなる
  - 関連する語：到達可能、連結、連結クラス
- [周期性](./periodicity.md)
  - 周期が1より大きい
  - 関連する語：周期、循環クラス
- [再帰性](./recursion.md)
  - 必ず有限ステップで戻って来るなら再帰的
  - 再帰的か一時的か
    - 再帰的：$P(T_i<\infty\mid X_0 = i) = 1$
    - 一時的：$P(T_i<\infty \mid X_0=i) < 1$
  - 再帰的だとして、正再帰的なのか零再帰的なのか
    - 正再帰的：$E[T_i\mid X_0 = i]<\infty$
    - 零再帰的：$E[T_i\mid X_0 = i] = \infty$
  - 関連する語：再帰時間、再帰的

## マルコフ連鎖を特徴づけるものたち

- [推移確率行列](./transision-probability-matrix.md)
  - 連続の場合は推移確率行列関数になる（つまり要素が時間の関数になる）
- 状態遷移図
  - 各状態に対応するノードがある
  - ノード同士が有向グラフで結ばれていてその重みが推移確率になっている
- [確率再帰](./probablistic-resurcion.md)
  - 任意のマルコフ連鎖は、独立な確率変数と関数を使って表現できる
- 初期状態の確率分布
- [定常分布](./stationary-distribution.md)
  - 推移確率行列の固有値1に対応する左固有ベクトル

連続の場合は

- [生成作用素](./generator.md)
  - 別名：Q行列、生成作用素
  - 推移確率行列関数を$t=0$で微分したようなもの

## マルコフ連鎖の性質

- マルコフ性
  - 過去の状態に依存しない
- [確率再帰](./probablistic-resurcion.md)で表現できる
- 初期状態の確率分布と[推移確率行列](./transision-probability-matrix.md)がわかれば、その後の確率分布が分かる

## 問題を解くときに

- 状態集合が有限なら、状況を整理するために状態遷移図を書くといい
- 推移確率行列が得られても、**行列をかける必要はない**。
  - 行列を掛けるということは、分布全体の変化を一気に考えるということ
  - 一気に考えなくても、路ごとに考えればいいこともある
    - $0\to1\to2\to1$の変化を$p_{01}\to p_{12} \to p_{20}$で考えるみたいなこと
    - 既約性を考えるときとか、有限なら$0\to1\to\cdots \to d\to0$の確率が正であることを示せれば十分
- 連結に注目した分類について
  - 連結クラスで分類
  - 連結クラスごとに、閉じているか閉じていないか判定
- 性質の分類をするとき
  - 既約なら1つの状態について考えればいい
- 簡単な部分に分割する
  - 既約＆正再帰的＆非周期的（エルゴート的）なときが簡単
  - 既約でなければ**連結クラスに分割**
  - 周期的であれば**循環クラスに分割**
